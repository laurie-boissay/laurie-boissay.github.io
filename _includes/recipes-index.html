<!-- _includes/recipes-index.html -->
<div id="recipes-index">
  <!-- Boucle sur chaque groupe de recettes passÃ© par l'include -->
  {% for g in include.grouped %}
    <h3 id="{{ g.name | slugify }}" class="recipe-category-title">
      <!-- Titre du groupe de recettes, cliquable pour accÃ©der directement Ã  la section du groupe -->
      <a href="#{{ g.name | slugify }}">{{ g.name }}</a>
    </h3>

    <div class="recipe-group-block mb-4" data-recipe-group="{{ g.name | escape }}">
      <!-- Trie les recettes dans le groupe par le champ 'recipe_sort' -->
      {% assign group_recipes = g.items | sort: "recipe_sort" %}

      <div class="recipes-grid">
        <!-- Boucle sur chaque recette dans le groupe -->
        {% for r in group_recipes %}
          <article
            class="recipe-card mb-2"
            data-tags="{{ r.tags | join: ',' | escape }}"
            data-micros="{{ r.badges_nutritionnels | join: ',' | escape }}"
          >
            <a
              class="recipe-card-link"
              href="{{ r.url | relative_url }}"
              data-tested="{{ r.recipe_tested }}"
              data-title="{{ r.recipe_title | escape }}"
            >
              <div class="recipe-card-top">
                <h4 class="recipe-card-title">{{ r.recipe_title }}</h4>
                
                <!-- Affiche le sous-titre de la recette si prÃ©sent -->
                {% if r.recipe_subtitle %}
                  <h5 class="recipe-card-subtitle">{{ r.recipe_subtitle }}</h5>
                {% endif %}

                <!-- Affiche un badge "Recette non testÃ©e" si la recette n'a pas encore Ã©tÃ© testÃ©e -->
                {% if r.recipe_tested == false %}
                  <span class="badge bg-warning text-dark ms-2">Recette non testÃ©e</span>
                {% endif %}
              </div>

              <div class="recipe-badges-wrap">
                {% if r.tags %}
                  <ul class="recipe-badges-line badges-tags" aria-label="Badges">
                    <!-- Boucle sur les tags de la recette et les affiche s'ils ne sont pas dans 'hidden_tags' -->
                    {% for tag in r.tags %}
                      {% unless include.hidden_tags contains tag %}
                        {% case tag %}
                          {% when "tres-proteine" %}<li title="TrÃ¨s protÃ©inÃ©">ğŸ’ª</li>
                          {% when "riche-en-fibres" %}<li title="Riche en fibres">ğŸ’©</li>
                          {% when "rapide" %}<li title="Rapide">â±ï¸</li>
                          {% when "congelable" %}<li title="CongÃ©lable">â„ï¸</li>
                          {% when "micro-ondable" %}<li title="Micro-ondable">â™¨ï¸</li>
                          {% when "peu-calorique" %}<li title="Peu calorique">ğŸª¶</li>
                          {% when "calorique" %}<li title="Calorique">ğŸ”¥</li>
                          {% when "longue" %}<li title="PrÃ©paration longue">ğŸŒ</li>
                          {% when "gout-sucre" %}<li title="GoÃ»t sucrÃ©">ğŸ¬</li>
                        {% endcase %}
                      {% endunless %}
                    {% endfor %}
                  </ul>
                {% endif %}

                <!-- Ligne 2 : affichage des badges de micronutriments (s'ils sont prÃ©sents) -->
                {% assign micros = r.badges_nutritionnels | default: "" %}
                {% if micros and micros.size > 0 %}
                  <ul class="recipe-badges-line badges-micro" aria-label="Micronutriments">
                    {% for m in micros %}
                      {% case m %}
                        {% when "omega-3" %}<li title="OmÃ©ga-3">ğŸŸ</li>
                        {% when "vitamine-a" %}<li title="Vitamine A">ğŸ‘ï¸</li>
                        {% when "vitamine-c" %}<li title="Vitamine C">ğŸ‹</li>
                        {% when "vitamine-d" %}<li title="Vitamine D">ğŸŒ¤ï¸</li>
                        {% when "vitamine-e" %}<li title="Vitamine E">ğŸ›¡ï¸</li>
                        {% when "vitamine-k" %}<li title="Vitamine K">ğŸ©¸</li>
                        {% when "vitamine-b9" %}<li title="Vitamine B9">ğŸŒ±</li>
                        {% when "vitamine-b12" %}<li title="Vitamine B12">ğŸ¥©</li>
                        {% when "calcium" %}<li title="Calcium">ğŸ¦´</li>
                        {% when "fer" %}<li title="Fer">ğŸ§²</li>
                        {% when "magnesium" %}<li title="MagnÃ©sium">âš¡</li>
                        {% when "potassium" %}<li title="Potassium">ğŸŒ</li>
                        {% when "zinc" %}<li title="Zinc">ğŸ”©</li>
                        {% when "selenium" %}<li title="SÃ©lÃ©nium">ğŸ§ª</li>
                        {% when "iode" %}<li title="Iode">ğŸŒŠ</li>
                      {% endcase %}
                    {% endfor %}
                  </ul>
                {% endif %}
              </div>

            </a>
          </article>
        {% endfor %}
      </div>

    </div>
  {% endfor %}
</div>


---
layout: page
title: "Recettes low carb"
description: "Mes recettes low carb (recettes faibles en glucides). Index par catÃ©gories."
page_h1: "Mes recettes low carb"
page_h3: "ou recettes faibles en glucides"
body_id: "home"
---

<section id="index">
  <h2>Index des recettes</h2>

  <!-- =========================================================
       SUGGESTION ALÃ‰ATOIRE
       ========================================================= -->
  <div class="mb-4">
    <div id="random-pick"></div>

    <!--
      âœ… Bloc â€œinfos tags + micronutrimentsâ€
      - Ce bloc est HORS tirage : il sert juste de navigation rapide.
      - On inclut volontairement "gout-sucre" ici, mÃªme si tu lâ€™exclus du tirage alÃ©atoire.
      - Les URLs supposent que tu as des pages /tags/<id>/ et /micronutriments/<id>/.
    -->
    <div class="random-pick-links mt-2">

      <!-- Ligne 1 : tags fonctionnels -->
      <ul class="recipe-badges-line badges-tags-fixed" aria-label="Tags fonctionnels">
        <li><a class="badge-link-outside" href="{{ '/tags/tres-proteine/' | relative_url }}" title="TrÃ¨s protÃ©inÃ©">ğŸ’ª</a></li>
        <li><a class="badge-link-outside" href="{{ '/tags/riche-en-fibres/' | relative_url }}" title="Riche en fibres">ğŸ’©</a></li>
        <li><a class="badge-link-outside" href="{{ '/tags/rapide/' | relative_url }}" title="Rapide">â±ï¸</a></li>
        <li><a class="badge-link-outside" href="{{ '/tags/congelable/' | relative_url }}" title="CongÃ©lable">â„ï¸</a></li>
        <li><a class="badge-link-outside" href="{{ '/tags/micro-ondable/' | relative_url }}" title="Micro-ondable">â™¨ï¸</a></li>
        <li><a class="badge-link-outside" href="{{ '/tags/peu-calorique/' | relative_url }}" title="Peu calorique">ğŸª¶</a></li>
        <li><a class="badge-link-outside" href="{{ '/tags/calorique/' | relative_url }}" title="Calorique">ğŸ”¥</a></li>
        <li><a class="badge-link-outside" href="{{ '/tags/longue/' | relative_url }}" title="PrÃ©paration longue">ğŸŒ</a></li>

        <!-- Tag cachÃ© dans les badges â€œfonctionnelsâ€ des cartes, mais OK en navigation -->
        <li><a class="badge-link-outside" href="{{ '/tags/gout-sucre/' | relative_url }}" title="GoÃ»t sucrÃ©">ğŸ¬</a></li>
      </ul>

      <!-- Ligne 2 : micronutriments -->
      <ul class="recipe-badges-line badges-micro-fixed" aria-label="Micronutriments">
        <li><a class="badge-link-outside" href="{{ '/micronutriments/omega-3/' | relative_url }}" title="OmÃ©ga-3">ğŸŸ</a></li>

        <li><a class="badge-link-outside" href="{{ '/micronutriments/vitamine-a/' | relative_url }}" title="Vitamine A">ğŸ‘ï¸</a></li>
        <li><a class="badge-link-outside" href="{{ '/micronutriments/vitamine-c/' | relative_url }}" title="Vitamine C">ğŸ‹</a></li>
        <li><a class="badge-link-outside" href="{{ '/micronutriments/vitamine-d/' | relative_url }}" title="Vitamine D">ğŸŒ¤ï¸</a></li>
        <li><a class="badge-link-outside" href="{{ '/micronutriments/vitamine-e/' | relative_url }}" title="Vitamine E">ğŸ›¡ï¸</a></li>
        <li><a class="badge-link-outside" href="{{ '/micronutriments/vitamine-k/' | relative_url }}" title="Vitamine K">ğŸ©¸</a></li>
        <li><a class="badge-link-outside" href="{{ '/micronutriments/vitamine-b9/' | relative_url }}" title="Vitamine B9">ğŸŒ±</a></li>
        <li><a class="badge-link-outside" href="{{ '/micronutriments/vitamine-b12/' | relative_url }}" title="Vitamine B12">ğŸ¥©</a></li>

        <li><a class="badge-link-outside" href="{{ '/micronutriments/calcium/' | relative_url }}" title="Calcium">ğŸ¦´</a></li>
        <li><a class="badge-link-outside" href="{{ '/micronutriments/fer/' | relative_url }}" title="Fer">ğŸ§²</a></li>
        <li><a class="badge-link-outside" href="{{ '/micronutriments/magnesium/' | relative_url }}" title="MagnÃ©sium">âš¡</a></li>
        <li><a class="badge-link-outside" href="{{ '/micronutriments/potassium/' | relative_url }}" title="Potassium">ğŸŒ</a></li>
        <li><a class="badge-link-outside" href="{{ '/micronutriments/zinc/' | relative_url }}" title="Zinc">ğŸ”©</a></li>
        <li><a class="badge-link-outside" href="{{ '/micronutriments/selenium/' | relative_url }}" title="SÃ©lÃ©nium">ğŸ§ª</a></li>
        <li><a class="badge-link-outside" href="{{ '/micronutriments/iode/' | relative_url }}" title="Iode">ğŸŒŠ</a></li>
      </ul>

    </div>
  </div>

  <!-- =========================================================
       INDEX PAR CATÃ‰GORIES
       ========================================================= -->

  {% assign all_recipes = site.pages | where: "layout", "recipe" | where_exp: "p", "p.recipe_group" %}
  {% assign grouped = all_recipes | group_by: "recipe_group" | sort: "name" %}

  <!--
    Tags "techniques" / cachÃ©s : pas affichÃ©s dans les badges sur les cartes
    (mais ils existent pour filtrer / organiser)
  -->
  {%- assign hidden_tags = "low-carb-modere,low-carb-strict,gout-sucre" | split: "," -%}

  <div id="recipes-index">
    {% for g in grouped %}
      <h3 id="{{ g.name | slugify }}" class="recipe-category-title">
        <a href="#{{ g.name | slugify }}">{{ g.name }}</a>
      </h3>

      <div class="recipe-group-block mb-4" data-recipe-group="{{ g.name | escape }}">
        {% assign group_recipes = g.items | sort: "recipe_sort" %}

        <div class="recipes-grid">
          {% for r in group_recipes %}
            <article
              class="recipe-card mb-2"
              data-tags="{{ r.tags | join: ',' | escape }}"
              data-micros="{{ r.badges_nutritionnels | join: ',' | escape }}"
            >
              <a
                class="recipe-card-link"
                href="{{ r.url | relative_url }}"
                data-tested="{{ r.recipe_tested }}"
                data-title="{{ r.recipe_title | escape }}"
                data-subtitle="{{ r.recipe_subtitle | default: '' | strip_html | escape }}"
              >
                <div class="recipe-card-top">
                  <h4 class="recipe-card-title">{{ r.recipe_title }}</h4>
                </div>

                {% if r.recipe_subtitle %}
                  <p class="recipe-card-subtitle mb-1">{{ r.recipe_subtitle }}</p>
                {% endif %}

                {% if r.recipe_tested == false %}
                  <span class="badge bg-warning text-dark mb-2">Recette non testÃ©e</span>
                {% endif %}

                <div class="recipe-badges-wrap">

                  <!--
                    LIGNE 1 : TAGS FONCTIONNELS (badges)
                    - On ignore les tags cachÃ©s (low-carb-* + gout-sucre).
                  -->
                  {% if r.tags %}
                    <ul class="recipe-badges-line badges-tags" aria-label="Badges">
                      {% for tag in r.tags %}
                        {% unless hidden_tags contains tag %}
                          {% case tag %}
                            {% when "tres-proteine" %}<li title="TrÃ¨s protÃ©inÃ©">ğŸ’ª</li>
                            {% when "riche-en-fibres" %}<li title="Riche en fibres">ğŸ’©</li>
                            {% when "rapide" %}<li title="Rapide">â±ï¸</li>
                            {% when "congelable" %}<li title="CongÃ©lable">â„ï¸</li>
                            {% when "micro-ondable" %}<li title="Micro-ondable">â™¨ï¸</li>
                            {% when "peu-calorique" %}<li title="Peu calorique">ğŸª¶</li>
                            {% when "calorique" %}<li title="Calorique">ğŸ”¥</li>
                            {% when "longue" %}<li title="PrÃ©paration longue">ğŸŒ</li>
                          {% endcase %}
                        {% endunless %}
                      {% endfor %}
                    </ul>
                  {% endif %}

                  <!--
                    LIGNE 2 : MICRONUTRIMENTS
                    - AffichÃ©e seulement si badges_nutritionnels existe ET a au moins 1 Ã©lÃ©ment.
                  -->
                  {% assign micros = r.badges_nutritionnels | default: "" %}
                  {% if micros and micros.size > 0 %}
                    <ul class="recipe-badges-line badges-micro" aria-label="Micronutriments">
                      {% for m in micros %}
                        {% case m %}
                          {% when "omega-3" %}<li title="OmÃ©ga-3">ğŸŸ</li>

                          {% when "vitamine-a" %}<li title="Vitamine A">ğŸ‘ï¸</li>
                          {% when "vitamine-c" %}<li title="Vitamine C">ğŸ‹</li>
                          {% when "vitamine-d" %}<li title="Vitamine D">ğŸŒ¤ï¸</li>
                          {% when "vitamine-e" %}<li title="Vitamine E">ğŸ›¡ï¸</li>
                          {% when "vitamine-k" %}<li title="Vitamine K">ğŸ©¸</li>
                          {% when "vitamine-b9" %}<li title="Vitamine B9">ğŸŒ±</li>
                          {% when "vitamine-b12" %}<li title="Vitamine B12">ğŸ¥©</li>

                          {% when "calcium" %}<li title="Calcium">ğŸ¦´</li>
                          {% when "fer" %}<li title="Fer">ğŸ§²</li>
                          {% when "magnesium" %}<li title="MagnÃ©sium">âš¡</li>
                          {% when "potassium" %}<li title="Potassium">ğŸŒ</li>
                          {% when "zinc" %}<li title="Zinc">ğŸ”©</li>
                          {% when "selenium" %}<li title="SÃ©lÃ©nium">ğŸ§ª</li>
                          {% when "iode" %}<li title="Iode">ğŸŒŠ</li>
                        {% endcase %}
                      {% endfor %}
                    </ul>
                  {% endif %}

                </div>
              </a>
            </article>
          {% endfor %}
        </div>
      </div>
    {% endfor %}
  </div>
</section>

<script>
  /*
    =========================================================
    RANDOM PICK
    - Exclut toutes les recettes taguÃ©es gout-sucre
    - Exclut certains recipe_group du tirage
    - Affiche aussi les badges (tags + micronutriments) de la recette tirÃ©e
    =========================================================
  */

  // Tag exclu du tirage
  const EXCLUDED_TAG = "gout-sucre";

  // Tags cachÃ©s (utiles cÃ´tÃ© data, mais pas affichÃ©s comme badges "fonctionnels")
  const HIDDEN_TAGS = new Set(["low-carb-modere","low-carb-strict","gout-sucre"]);

  // Exclusions du tirage alÃ©atoire par recipe_group (comparaison en minuscules)
  // IMPORTANT : ici tu compares une valeur "humaine" (ex: "Plats Ã  base de viande")
  // donc tu dois mettre exactement la version en minuscules.
  const EXCLUDED_GROUPS = [
    "amuse-bouche",
    "boissons",
    "pains & substituts",
    "pÃ¢tes & fonds",
    "sauces & assaisonnements",
    "lÃ©gumes & accompagnements",
    "prÃ©parations & conservations",
    "barres nutritionnelles"
  ];

  // Mapping tag -> { emoji, title }
  const TAG_BADGES = {
    "tres-proteine":   { emoji: "ğŸ’ª", title: "TrÃ¨s protÃ©inÃ©" },
    "riche-en-fibres": { emoji: "ğŸ’©", title: "Riche en fibres" },
    "rapide":          { emoji: "â±ï¸", title: "Rapide" },
    "congelable":      { emoji: "â„ï¸", title: "CongÃ©lable" },
    "micro-ondable":   { emoji: "â™¨ï¸", title: "Micro-ondable" },
    "peu-calorique":   { emoji: "ğŸª¶", title: "Peu calorique" },
    "calorique":       { emoji: "ğŸ”¥", title: "Calorique" },
    "longue":          { emoji: "ğŸŒ", title: "PrÃ©paration longue" }
  };

  // Mapping micronutriment -> { emoji, title }
  const MICRO_BADGES = {
    "omega-3":      { emoji: "ğŸŸ", title: "OmÃ©ga-3" },

    "vitamine-a":   { emoji: "ğŸ‘ï¸", title: "Vitamine A" },
    "vitamine-c":   { emoji: "ğŸ‹", title: "Vitamine C" },
    "vitamine-d":   { emoji: "ğŸŒ¤ï¸", title: "Vitamine D" },
    "vitamine-e":   { emoji: "ğŸ›¡ï¸", title: "Vitamine E" },
    "vitamine-k":   { emoji: "ğŸ©¸", title: "Vitamine K" },
    "vitamine-b9":  { emoji: "ğŸŒ±", title: "Vitamine B9" },
    "vitamine-b12": { emoji: "ğŸ¥©", title: "Vitamine B12" },

    "calcium":      { emoji: "ğŸ¦´", title: "Calcium" },
    "fer":          { emoji: "ğŸ§²", title: "Fer" },
    "magnesium":    { emoji: "âš¡", title: "MagnÃ©sium" },
    "potassium":    { emoji: "ğŸŒ", title: "Potassium" },
    "zinc":         { emoji: "ğŸ”©", title: "Zinc" },
    "selenium":     { emoji: "ğŸ§ª", title: "SÃ©lÃ©nium" },
    "iode":         { emoji: "ğŸŒŠ", title: "Iode" }
  };

  const indexRoot = document.getElementById("recipes-index");
  const pickHost = document.getElementById("random-pick");

  // Pour Ã©viter de retomber sur la mÃªme recette trop souvent
  let lastHref = null;

  // Convertit "a,b,c" -> ["a","b","c"] en minuscules
  function parseList(str) {
    return (str || "")
      .split(",")
      .map(s => s.trim().toLowerCase())
      .filter(Boolean);
  }

  // VÃ©rifie si le lien correspond Ã  une recette exploitable
  function isValidRecipeLink(a) {
    const href = (a.getAttribute("href") || "").trim();
    if (!href) return false;

    // On ignore les ancres
    if (href.startsWith("#")) return false;

    // Si ton site sort du .html, enlÃ¨ve ce test. Sinon, Ã§a Ã©vite de prendre des liens parasites.
    // (Si tu as des URLs propres sans .html, supprime cette ligne.)
    // if (!href.endsWith(".html")) return false;

    const title = (a.dataset.title || a.textContent || "").trim();
    if (!title) return false;

    return true;
  }

  // Exclut les cartes taguÃ©es gout-sucre
  function hasExcludedTag(card) {
    const tags = parseList(card?.dataset?.tags);
    return tags.includes(EXCLUDED_TAG);
  }

  // Exclut certains recipe_group
  function isInExcludedGroup(a) {
    const groupEl = a.closest("[data-recipe-group]");
    if (!groupEl) return false;

    const group = (groupEl.dataset.recipeGroup || "").toLowerCase().trim();
    return EXCLUDED_GROUPS.includes(group);
  }

  // Liste des candidats au tirage
  function getCandidates() {
    if (!indexRoot) return [];

    return Array.from(indexRoot.querySelectorAll(".recipe-card a[href]"))
      .filter(isValidRecipeLink)
      .filter(a => {
        const card = a.closest(".recipe-card");
        if (!card) return false;

        if (hasExcludedTag(card)) return false;
        if (isInExcludedGroup(a)) return false;

        return true;
      });
  }

  // Tirage alÃ©atoire (Ã©vite de rÃ©pÃ©ter la mÃªme recette)
  function pickRandom(links) {
    if (!links.length) return null;

    let a, tries = 0;
    do {
      a = links[Math.floor(Math.random() * links.length)];
      tries++;
    } while (a.getAttribute("href") === lastHref && tries < 20);

    lastHref = a.getAttribute("href");
    return a;
  }

  // Construit une ligne de badges (UL) Ã  partir dâ€™une liste dâ€™IDs et dâ€™un mapping
  function buildBadgeLine(items, map, ariaLabel) {
    const lis = items
      .map(id => {
        const info = map[id];
        if (!info) return "";
        const title = (info.title || "").replace(/"/g, "&quot;");
        return `<li title="${title}">${info.emoji}</li>`;
      })
      .filter(Boolean)
      .join("");

    if (!lis) return "";
    return `<ul class="recipe-badges-line" aria-label="${ariaLabel}">${lis}</ul>`;
  }

  // Badges Ã  afficher dans le random pick pour UNE recette
  function buildPickBadges(card) {
    const tagsAll = parseList(card?.dataset?.tags);

    // Tags fonctionnels : on enlÃ¨ve les tags cachÃ©s + on garde seulement ceux quâ€™on connaÃ®t dans TAG_BADGES
    const tagsFunctional = tagsAll.filter(t => !HIDDEN_TAGS.has(t) && TAG_BADGES[t]);

    const microsAll = parseList(card?.dataset?.micros);
    const micros = microsAll.filter(m => MICRO_BADGES[m]);

    const line1 = buildBadgeLine(tagsFunctional, TAG_BADGES, "Badges");
    const line2 = buildBadgeLine(micros, MICRO_BADGES, "Micronutriments");

    if (!line1 && !line2) return "";
    return `
      <div class="recipe-badges-wrap">
        ${line1}
        ${line2}
      </div>
    `;
  }

  // Affiche la carte â€œOn mange quoi ?â€
  function renderPick(a) {
    const title = (a.dataset.title || a.textContent || "").trim();
    const subtitle = (a.dataset.subtitle || "").trim();
    const tested = a.dataset.tested === "true";
    const href = a.getAttribute("href");

    const card = a.closest(".recipe-card");
    const badgesHtml = buildPickBadges(card);

    pickHost.innerHTML = `
      <div class="pick-card">
        <div class="pick-card-body text-center">
          <div class="mb-2 fw-bold fs-4">On mange quoi&nbsp;?</div>

          <h3 class="h5 mb-1">
            ${title}
            ${tested ? "" : `
              <span class="badge bg-warning text-dark ms-2">
                Recette non testÃ©e
              </span>
            `}
          </h3>

          ${subtitle ? `<div class="recipe-card-subtitle mb-2">${subtitle}</div>` : ""}

          ${badgesHtml}

          <div class="d-flex justify-content-center gap-2 mt-3">
            <a class="btn btn-primary" href="${href}">Ã‡a me plaÃ®t</a>
            <button id="btn-reroll" type="button" class="btn btn-outline-secondary">Autre idÃ©e</button>
          </div>
        </div>
      </div>
    `;

    document.getElementById("btn-reroll").onclick = pickAndRender;
  }

  function renderEmpty() {
    pickHost.innerHTML = `
      <div class="alert alert-warning mb-0">
        Aucune recette disponible.
      </div>
    `;
  }

  function pickAndRender() {
    const links = getCandidates();
    if (!links.length) return renderEmpty();

    const a = pickRandom(links);
    if (!a) return renderEmpty();

    renderPick(a);
  }

  // Lancement initial
  pickAndRender();
</script>


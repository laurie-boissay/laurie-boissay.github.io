---
layout: page
title: "Recettes low carb"
filter_title: "Recettes"
description: "Mes recettes low carb (recettes faibles en glucides). Index par cat√©gories."
page_h1: "Index"
page_h3: "Mes recettes low carb"
body_id: "home"
---

<section id="index" style="text-align: center;">
  <h2>On mange quoi ?</h2>

  <div id="recipe-container">
    <p>Chargement d'une recette al√©atoire...</p>
  </div>

  <!-- Boutons sous la recette -->
  <div id="recipe-buttons" style="margin-top: 20px;">
    <a id="view-recipe" href="#" style="margin-right: 20px; padding: 10px 20px; font-size: 16px; text-decoration: none; border-radius: 5px; background-color: #14b8a6; color: white; display: inline-block;">Voir la recette</a>
    <button id="view-another" style="padding: 10px 20px; font-size: 16px;">Voir une autre</button>
  </div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const recipeCards = document.querySelectorAll('.recipe-card');

    if (recipeCards.length === 0) {
      document.getElementById('recipe-container').innerHTML = '<p>Aucune recette disponible.</p>';
      return;
    }

    // Choisir une recette au hasard parmi celles pr√©sentes sur la page
    const randomIndex = Math.floor(Math.random() * recipeCards.length);
    const randomRecipe = recipeCards[randomIndex];

    const title = randomRecipe.querySelector('.recipe-card-title') ? randomRecipe.querySelector('.recipe-card-title').innerText : 'Titre non trouv√©';

    const recipeLink = randomRecipe.querySelector('a');  // Rechercher l'√©l√©ment <a> de la carte de recette
    const url = recipeLink ? recipeLink.href : '#'; // Si l'√©l√©ment <a> existe, r√©cup√©rer l'URL, sinon # par d√©faut

    const subtitle = randomRecipe.querySelector('.recipe-card-subtitle') 
      ? randomRecipe.querySelector('.recipe-card-subtitle').innerText 
      : 'Pas de sous-titre disponible.';

    const badgesLine = randomRecipe.querySelector('.recipe-badges-line') 
      ? randomRecipe.querySelector('.recipe-badges-line').innerHTML 
      : '';

    const micronutrientTags = randomRecipe.dataset.micros 
      ? randomRecipe.dataset.micros.split(',') 
      : [];

    const micronutrientBadges = {
      "iode": "üåä",
      "vitamine-b12": "ü•©",
      "vitamine-a": "üëÅÔ∏è",
      "vitamine-c": "üçã",
      "vitamine-d": "üå§Ô∏è",
      "vitamine-e": "üõ°Ô∏è",
      "calcium": "ü¶¥",
      "fer": "üß≤",
      "magnesium": "‚ö°",
      "potassium": "üçå",
      "zinc": "üî©",
      "selenium": "üß™",
      "vitamine-b9": "üå±",
      "omega-3": "üêü",
    };

    const micronutrientBadgeTags = micronutrientTags.map(tag => {
      const badge = micronutrientBadges[tag] || tag;
      return `<li class="badge-micronutrient">${badge}</li>`;
    }).join('');

    const recipeContainer = document.getElementById('recipe-container');

    recipeContainer.innerHTML = `
      <div class="recipe-card" style="text-align: center;">
        <h3 class="recipe-title">
          <a href="${url}">${title}</a>
        </h3>
        <p class="recipe-subtitle">${subtitle}</p>
        <ul class="recipe-badges-line">
          ${badgesLine}
        </ul>
        ${micronutrientBadgeTags ? `
        <ul class="recipe-badges-line badges-micro">
          ${micronutrientBadgeTags}
        </ul>
        ` : ''}
      </div>
    `;

    // Afficher le badge "Recette non test√©e" si la recette al√©atoire n'a pas √©t√© test√©e
    {% comment %}
      On affiche le badge "Recette non test√©e" uniquement pour la recette al√©atoire si elle est marqu√©e comme non test√©e.
    {% endcomment %}
    {% if randomRecipe.recipe_tested == false %}
      const badgeNonTestee = document.createElement('span');
      badgeNonTestee.innerHTML = '<span class="badge" style="background-color: #f59e0b; color: white; padding: 5px 10px; border-radius: 5px; font-size: 14px;">‚ö† Recette non test√©e</span>';
      document.querySelector('.recipe-card').appendChild(badgeNonTestee);
    {% endif %}

    // Assigner l'URL correctement au bouton "Voir la recette"
    const viewRecipeButton = document.getElementById('view-recipe');
    viewRecipeButton.setAttribute('href', url); // Mettre √† jour le href avec l'URL de la recette
    console.log("URL du bouton 'Voir la recette' :", viewRecipeButton.getAttribute('href')); // V√©rifier que l'URL a bien √©t√© mise √† jour

    // Ajouter l'√©v√©nement pour le bouton "Voir une autre"
    document.getElementById('view-another').addEventListener('click', function() {
      location.reload(); // Recharger la page pour afficher une nouvelle recette al√©atoire
    });
  });
</script>

  <!-- R√©cup√®re toutes les pages du site qui utilisent le layout "recipe" -->
  {% assign all_recipes = site.pages | where: "layout", "recipe" %}

  {% if all_recipes.size > 0 %}
    {% assign grouped = all_recipes | group_by: "recipe_group" | sort: "name" %}
    {% include recipes-index.html grouped=grouped hidden_tags=hidden_tags %}
  {% else %}
    <p>Aucune recette disponible.</p>
  {% endif %}

  <hr class="my-4">

  <div class="text-center muted">
    Derni√®re mise √† jour le {{ site.time | date: "%d/%m/%Y" }}
  </div>
</section>


---
layout: page
title: "Recettes low carb"
description: "Mes recettes low carb (recettes faibles en glucides). Index par catÃ©gories."
page_h1: "Mes recettes low carb"
page_h3: "ou recettes faibles en glucides"
body_id: "home"
---

<section id="index">
  <h2>Index des recettes</h2>

  <!-- Suggestion alÃ©atoire -->
  <div class="mb-4">
    <div id="random-pick"></div>
  </div>

  {% assign all_recipes = site.pages | where: "layout", "recipe" | where_exp: "p", "p.recipe_group" %}
  {% assign grouped = all_recipes | group_by: "recipe_group" | sort: "name" %}

  {%- assign hidden_tags = "low-carb-modere,low-carb-strict,gout-sucre" | split: "," -%}

  <div id="recipes-index">
    {% for g in grouped %}
      <h3 id="{{ g.name | slugify }}" class="recipe-category-title">
        <a href="#{{ g.name | slugify }}">{{ g.name }}</a>
      </h3>

      <div class="recipe-group-block mb-4" data-recipe-group="{{ g.name | escape }}">
        {% assign group_recipes = g.items | sort: "recipe_sort" %}

        <div class="recipes-grid">
          {% for r in group_recipes %}
            <article
              class="recipe-card mb-2"
              data-tags="{{ r.tags | join: ',' | escape }}"
              data-micros="{{ r.badges_nutritionnels | join: ',' | escape }}"
            >
              <a
                class="recipe-card-link"
                href="{{ r.url | relative_url }}"
                data-tested="{{ r.recipe_tested }}"
                data-title="{{ r.recipe_title | escape }}"
                data-subtitle="{{ r.recipe_subtitle | default: '' | strip_html | escape }}"
              >
                <div class="recipe-card-top">
                  <h4 class="recipe-card-title">{{ r.recipe_title }}</h4>
                </div>

                {% if r.recipe_subtitle %}
                  <p class="recipe-card-subtitle mb-1">{{ r.recipe_subtitle }}</p>
                {% endif %}

                {% if r.recipe_tested == false %}
                  <span class="badge bg-warning text-dark mb-2">Recette non testÃ©e</span>
                {% endif %}

                <div class="recipe-badges-wrap">
                  {% if r.tags %}
                    <ul class="recipe-badges-line badges-tags">
                      {% for tag in r.tags %}
                        {% unless hidden_tags contains tag %}
                          {% case tag %}
                            {% when "tres-proteine" %}<li>ğŸ’ª</li>
                            {% when "riche-en-fibres" %}<li>ğŸ’©</li>
                            {% when "rapide" %}<li>â±ï¸</li>
                            {% when "congelable" %}<li>â„ï¸</li>
                            {% when "micro-ondable" %}<li>â™¨ï¸</li>
                            {% when "peu-calorique" %}<li>ğŸª¶</li>
                            {% when "calorique" %}<li>ğŸ”¥</li>
                            {% when "longue" %}<li>ğŸŒ</li>
                          {% endcase %}
                        {% endunless %}
                      {% endfor %}
                    </ul>
                  {% endif %}

                  {% if r.badges_nutritionnels and r.badges_nutritionnels.size > 0 %}
                    <ul class="recipe-badges-line badges-micro">
                      {% for m in r.badges_nutritionnels %}
                        {% case m %}
                          {% when "omega-3" %}<li>ğŸŸ</li>
                          {% when "calcium" %}<li>ğŸ¦´</li>
                        {% endcase %}
                      {% endfor %}
                    </ul>
                  {% endif %}
                </div>
              </a>
            </article>
          {% endfor %}
        </div>
      </div>
    {% endfor %}
  </div>
</section>

<script>
  const EXCLUDED_TAG = "gout-sucre";
  const HIDDEN_TAGS = new Set(["low-carb-modere","low-carb-strict","gout-sucre"]);
  const EXCLUDED_GROUPS = [
    "amuse-bouche",
    "boissons",
    "pains & substituts",
    "pÃ¢tes & fonds",
    "sauces & assaisonnements",
    "lÃ©gumes & accompagnements",
    "prÃ©parations & conservations",
    "barres nutritionnelles"
  ];

  const TAG_BADGES = {
    "tres-proteine": "ğŸ’ª",
    "riche-en-fibres": "ğŸ’©",
    "rapide": "â±ï¸",
    "congelable": "â„ï¸",
    "micro-ondable": "â™¨ï¸",
    "peu-calorique": "ğŸª¶",
    "calorique": "ğŸ”¥",
    "longue": "ğŸŒ"
  };

  const MICRO_BADGES = {
    "omega-3": "ğŸŸ",
    "calcium": "ğŸ¦´"
  };

  const indexRoot = document.getElementById("recipes-index");
  const pickHost = document.getElementById("random-pick");
  let lastHref = null;

  function parseList(str) {
    return (str || "").split(",").map(s => s.trim().toLowerCase()).filter(Boolean);
  }

  function getCandidates() {
    return Array.from(indexRoot.querySelectorAll(".recipe-card a[href]"))
      .filter(a => {
        const card = a.closest(".recipe-card");
        if (!card) return false;

        const tags = parseList(card.dataset.tags);
        if (tags.includes(EXCLUDED_TAG)) return false;

        const group = a.closest("[data-recipe-group]")?.dataset.recipeGroup?.toLowerCase();
        if (EXCLUDED_GROUPS.includes(group)) return false;

        return true;
      });
  }

  function pickRandom(links) {
    if (!links.length) return null;
    let a, tries = 0;
    do {
      a = links[Math.floor(Math.random() * links.length)];
      tries++;
    } while (a.getAttribute("href") === lastHref && tries < 20);
    lastHref = a.getAttribute("href");
    return a;
  }

  function renderPick(a) {
    const title = a.dataset.title;
    const subtitle = a.dataset.subtitle;
    const tested = a.dataset.tested === "true";
    const href = a.getAttribute("href");

    pickHost.innerHTML = `
      <div class="pick-card">
        <div class="pick-card-body text-center">
          <div class="mb-2 fw-bold fs-4">On mange quoi&nbsp;?</div>

          <h3 class="h5 mb-1">
            ${title}
            ${tested ? "" : `
              <span class="badge bg-warning text-dark ms-2">
                Recette non testÃ©e
              </span>
            `}
          </h3>

          ${subtitle ? `<div class="recipe-card-subtitle mb-2">${subtitle}</div>` : ""}

          <div class="d-flex justify-content-center gap-2 mt-3">
            <a class="btn btn-primary" href="${href}">Ã‡a me plaÃ®t</a>
            <button id="btn-reroll" class="btn btn-outline-secondary">Autre idÃ©e</button>
          </div>
        </div>
      </div>
    `;

    document.getElementById("btn-reroll").onclick = pickAndRender;
  }

  function pickAndRender() {
    const a = pickRandom(getCandidates());
    if (!a) return;
    renderPick(a);
  }

  pickAndRender();
</script>


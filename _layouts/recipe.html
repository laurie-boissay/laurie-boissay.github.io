<!DOCTYPE html>
<html lang="fr">
<head>
  {% include head.html %}

  {%- if page.extra_head -%}
    {{ page.extra_head }}
  {%- endif -%}

  {%- comment -%}
    IMPORTANT :
    - On ne met plus de CSS local ici.
    - Tout est centralisÃ© dans style.css pour Ã©viter les contradictions :
      * badges : wrap + centrÃ© (PAS de scroll horizontal)
      * photo : .recipe-photo
      * lÃ©gende : .badges-legend
  {%- endcomment -%}
</head>

<body class="container-fluid recipe{% if page.body_id %} {{ page.body_id }}{% endif %}">
  {% comment %}
    On Ã©vite le doublon de titres :
    - recipe-header.html affiche dÃ©jÃ  un h1
    - recipe.html affiche aussi un h1 (.recipe-title)
    => on retire l'include recipe-header.html ici.

    Si tu veux absolument garder recipe-header.html, il faudra supprimer
    le h1 ci-dessous (ou passer recipe-header.html en h2/h3).
  {% endcomment %}

  {% include navbar.html %}

  <main class="site-main">
    <div class="site-container">

      {% include bandeau-non-teste.html %}

      {%- comment -%}
        Tags "techniques" / cachÃ©s :
        - pas affichÃ©s dans les badges sur la page
        - mais ils restent utiles en metadata (filtre, organisation, etc.)
      {%- endcomment -%}
      {%- assign hidden_tags = "low-carb-modere,low-carb-strict,gout-sucre" | split: "," -%}

      <header class="recipe-head">
        <h1 class="recipe-title">{{ page.recipe_title | default: page.title }}</h1>

        {% comment %}
          Photo optionnelle (centralisÃ©e dans le layout) :
          - Ã€ activer par recette avec :
              image: "/images/recettes/mon-fichier.webp"
              image_alt: "Texte alternatif"
          - Si image_alt est absent, on retombe sur recipe_title/title.
          - relative_url garantit que Ã§a marche mÃªme si baseurl change.
        {% endcomment %}
        {% if page.image %}
          <figure class="recipe-photo">
            <img
              src="{{ page.image | relative_url }}"
              alt="{{ page.image_alt | default: page.recipe_title | default: page.title | escape }}"
              loading="lazy"
            >
          </figure>
        {% endif %}

        {%- comment -%}
          Badges :
          - Ligne 1 : tags fonctionnels (on ignore les tags cachÃ©s)
          - Ligne 2 : micronutriments (si prÃ©sents)
          NB : Le style (wrap + centrÃ©) est gÃ©rÃ© dans style.css via .recipe-badges-line
        {%- endcomment -%}
        <div class="recipe-badges-wrap">

          <!-- Ligne 1 : badges (tags) -->
          {% if page.tags %}
            <ul class="recipe-badges-line badges-tags" aria-label="Badges">
              {% for tag in page.tags %}
                {% unless hidden_tags contains tag %}
                  {% case tag %}
                    {% when "tres-proteine" %}<li title="TrÃ¨s protÃ©inÃ©">ğŸ’ª</li>
                    {% when "riche-en-fibres" %}<li title="Riche en fibres">ğŸ’©</li>
                    {% when "rapide" %}<li title="Rapide">â±ï¸</li>
                    {% when "congelable" %}<li title="CongÃ©lable">â„ï¸</li>
                    {% when "micro-ondable" %}<li title="Micro-ondable">â™¨ï¸</li>
                    {% when "peu-calorique" %}<li title="Peu calorique">ğŸª¶</li>
                    {% when "calorique" %}<li title="Calorique">ğŸ”¥</li>
                    {% when "longue" %}<li title="PrÃ©paration longue">ğŸŒ</li>
                  {% endcase %}
                {% endunless %}
              {% endfor %}
            </ul>
          {% endif %}

          <!-- Ligne 2 : micronutriments -->
          {% assign micros = page.badges_nutritionnels | default: "" %}
          {% if micros and micros.size > 0 %}
            <ul class="recipe-badges-line badges-micro" aria-label="Micronutriments">
              {% for m in micros %}
                {% case m %}
                  {% when "omega-3" %}<li title="OmÃ©ga-3">ğŸŸ</li>

                  {% when "vitamine-a" %}<li title="Vitamine A">ğŸ‘ï¸</li>
                  {% when "vitamine-c" %}<li title="Vitamine C">ğŸ‹</li>
                  {% when "vitamine-d" %}<li title="Vitamine D">ğŸŒ¤ï¸</li>
                  {% when "vitamine-e" %}<li title="Vitamine E">ğŸ›¡ï¸</li>
                  {% when "vitamine-k" %}<li title="Vitamine K">ğŸ©¸</li>
                  {% when "vitamine-b9" %}<li title="Vitamine B9">ğŸŒ±</li>
                  {% when "vitamine-b12" %}<li title="Vitamine B12">ğŸ¥©</li>

                  {% when "calcium" %}<li title="Calcium">ğŸ¦´</li>
                  {% when "fer" %}<li title="Fer">ğŸ§²</li>
                  {% when "magnesium" %}<li title="MagnÃ©sium">âš¡</li>
                  {% when "potassium" %}<li title="Potassium">ğŸŒ</li>
                  {% when "zinc" %}<li title="Zinc">ğŸ”©</li>
                  {% when "selenium" %}<li title="SÃ©lÃ©nium">ğŸ§ª</li>
                  {% when "iode" %}<li title="Iode">ğŸŒŠ</li>
                {% endcase %}
              {% endfor %}
            </ul>
          {% endif %}

          {%- comment -%}
            LÃ©gende des badges :
            - Le style est gÃ©rÃ© dans style.css via .badges-legend
            - Important : on laisse la liste en <ul> pour Ãªtre lisible/accessibilitÃ©.
          {%- endcomment -%}
          <details class="badges-legend">
            <summary>LÃ©gende des badges</summary>
            <ul>
              <li>ğŸ’ª TrÃ¨s protÃ©inÃ©</li>
              <li>ğŸ’© Riche en fibres</li>
              <li>â±ï¸ Rapide Ã  prÃ©parer</li>
              <li>â„ï¸ CongÃ©lable</li>
              <li>â™¨ï¸ Micro-ondable</li>
              <li>ğŸª¶ Peu calorique</li>
              <li>ğŸ”¥ Calorique</li>
              <li>ğŸŒ PrÃ©paration longue / temps passif important</li>
              <li>ğŸŸ OmÃ©ga-3</li>
              <li>ğŸ‘ï¸ Vitamine A</li>
              <li>ğŸ‹ Vitamine C</li>
              <li>ğŸŒ¤ï¸ Vitamine D</li>
              <li>ğŸ›¡ï¸ Vitamine E</li>
              <li>ğŸ©¸ Vitamine K</li>
              <li>ğŸŒ± Vitamine B9</li>
              <li>ğŸ¥© Vitamine B12</li>
              <li>ğŸ¦´ Calcium</li>
              <li>ğŸ§² Fer</li>
              <li>âš¡ MagnÃ©sium</li>
              <li>ğŸŒ Potassium</li>
              <li>ğŸ”© Zinc</li>
              <li>ğŸ§ª SÃ©lÃ©nium</li>
              <li>ğŸŒŠ Iode</li>
            </ul>
          </details>

        </div>
      </header>

      <div class="content-surface recipe-surface">
        {{ content }}
      </div>

      {% include footer.html %}

    </div>
  </main>

  {% include scripts.html %}
</body>
</html>

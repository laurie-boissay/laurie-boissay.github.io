<!DOCTYPE html>
<html lang="fr">
<head>
  {% include head.html %}

  {%- comment -%}
    =========================================================
    LAYOUT â€” RECETTE (STRUCTURANT)
    =========================================================
    RÃ´le :
    - Encadrer lâ€™affichage dâ€™une recette (titre, photo optionnelle, badges,
      bandeau "non testÃ©e", contenu, footer) en sâ€™appuyant sur les includes existants.

    EntrÃ©es (front-matter) :
    - page.title                 : fallback standard.
    - page.recipe_title          : titre affichÃ© sur la page (prioritaire sur page.title).
    - page.tags                  : tags fonctionnels + tags techniques (certains cachÃ©s).
    - page.badges_nutritionnels  : liste de micronutriments (IDs), affichÃ©e en seconde ligne.
    - page.image                 : (optionnel) chemin de lâ€™image de recette.
    - page.image_alt             : (optionnel) texte alternatif (fallback sur recipe_title/title).
    - page.body_id               : (optionnel) identifiant CSS ajoutÃ© Ã  <body>.
    - page.extra_head            : (optionnel) injection contrÃ´lÃ©e de balises dans <head> (ex: JSON-LD).

    DÃ©pendances / includes :
    - head.html                  : head commun (meta, CSS global, etc.).
    - navbar.html                : navigation.
    - bandeau-non-teste.html     : bandeau conditionnel (pilotÃ© par recipe_tested dans le front-matter).
    - footer.html + scripts.html : footer et scripts communs.

    Contrats / contraintes :
    - CSS :
      * aucun style local dans ce layout ; tout passe par style.css pour Ã©viter les divergences.
      * .recipe-badges-line gÃ¨re le wrap + centrage (pas de scroll horizontal).
      * .badge-link-card est utilisÃ© pour rendre les badges cliquables sans soulignement.
    - Titres :
      * ce layout rend le <h1> (.recipe-title) ; ne pas inclure dâ€™autre header gÃ©nÃ©rant un <h1>.
    - Tags :
      * certains tags sont "techniques" et doivent rester invisibles cÃ´tÃ© badges.
      * les tags fonctionnels (dont gout-sucre) sont affichÃ©s et cliquables.
    =========================================================
  {%- endcomment -%}

  {%- if page.extra_head -%}
    {{ page.extra_head }}
  {%- endif -%}
</head>

<body class="container-fluid recipe{% if page.body_id %} {{ page.body_id }}{% endif %}">
  {%- comment -%}
    PrÃ©vention doublon de titres :
    - recipe-header.html rend dÃ©jÃ  un <h1> dans son implÃ©mentation actuelle.
    - Ce layout rend Ã©galement un <h1> via .recipe-title.
    => On nâ€™inclut pas recipe-header.html ici.
  {%- endcomment -%}

  {% include navbar.html %}

  <main class="site-main">
    <div class="site-container">

      {% include bandeau-non-teste.html %}

      {%- comment -%}
        Tags techniques / cachÃ©s :
        - Non affichÃ©s dans les badges (UI) mais conservÃ©s dans page.tags pour le filtrage.
        Note :
        - gout-sucre Nâ€™EST PAS un tag technique : il doit Ãªtre affichÃ© (ğŸ¬) et cliquable.
      {%- endcomment -%}
      {%- assign hidden_tags = "low-carb-modere,low-carb-strict" | split: "," -%}

      <header class="recipe-head">
        <h1 class="recipe-title">{{ page.recipe_title | default: page.title }}</h1>

        {%- comment -%}
          Photo optionnelle :
          - ActivÃ©e uniquement si page.image est dÃ©fini.
          - relative_url garantit la compatibilitÃ© avec baseurl.
        {%- endcomment -%}
        {% if page.image %}
          <figure class="recipe-photo">
            <img
              src="{{ page.image | relative_url }}"
              alt="{{ page.image_alt | default: page.recipe_title | default: page.title | escape }}"
              loading="lazy"
            >
          </figure>
        {% endif %}

        {%- comment -%}
          Badges :
          - Ligne 1 : tags fonctionnels (cliquables vers /tags/<id>/)
          - Ligne 2 : micronutriments (cliquables vers /micronutriments/<id>/)
        {%- endcomment -%}
        <div class="recipe-badges-wrap">

          {% if page.tags %}
            <ul class="recipe-badges-line badges-tags" aria-label="Tags fonctionnels">
              {% for tag in page.tags %}
                {% unless hidden_tags contains tag %}
                  {% case tag %}
                    {% when "tres-proteine" %}
                      <li><a class="badge-link-card" href="{{ '/tags/tres-proteine/' | relative_url }}" title="TrÃ¨s protÃ©inÃ©">ğŸ’ª</a></li>
                    {% when "riche-en-fibres" %}
                      <li><a class="badge-link-card" href="{{ '/tags/riche-en-fibres/' | relative_url }}" title="Riche en fibres">ğŸ’©</a></li>
                    {% when "rapide" %}
                      <li><a class="badge-link-card" href="{{ '/tags/rapide/' | relative_url }}" title="Rapide">â±ï¸</a></li>
                    {% when "congelable" %}
                      <li><a class="badge-link-card" href="{{ '/tags/congelable/' | relative_url }}" title="CongÃ©lable">â„ï¸</a></li>
                    {% when "micro-ondable" %}
                      <li><a class="badge-link-card" href="{{ '/tags/micro-ondable/' | relative_url }}" title="Micro-ondable">â™¨ï¸</a></li>
                    {% when "peu-calorique" %}
                      <li><a class="badge-link-card" href="{{ '/tags/peu-calorique/' | relative_url }}" title="Peu calorique">ğŸª¶</a></li>
                    {% when "calorique" %}
                      <li><a class="badge-link-card" href="{{ '/tags/calorique/' | relative_url }}" title="Calorique">ğŸ”¥</a></li>
                    {% when "longue" %}
                      <li><a class="badge-link-card" href="{{ '/tags/longue/' | relative_url }}" title="PrÃ©paration longue">ğŸŒ</a></li>
                    {% when "gout-sucre" %}
                      <li><a class="badge-link-card" href="{{ '/tags/gout-sucre/' | relative_url }}" title="GoÃ»t sucrÃ©">ğŸ¬</a></li>
                  {% endcase %}
                {% endunless %}
              {% endfor %}
            </ul>
          {% endif %}

          {% assign micros = page.badges_nutritionnels | default: "" %}
          {% if micros and micros.size > 0 %}
            <ul class="recipe-badges-line badges-micro" aria-label="Micronutriments">
              {% for m in micros %}
                {% case m %}
                  {% when "omega-3" %}
                    <li><a class="badge-link-card" href="{{ '/micronutriments/omega-3/' | relative_url }}" title="OmÃ©ga-3">ğŸŸ</a></li>

                  {% when "vitamine-a" %}
                    <li><a class="badge-link-card" href="{{ '/micronutriments/vitamine-a/' | relative_url }}" title="Vitamine A">ğŸ‘ï¸</a></li>
                  {% when "vitamine-c" %}
                    <li><a class="badge-link-card" href="{{ '/micronutriments/vitamine-c/' | relative_url }}" title="Vitamine C">ğŸ‹</a></li>
                  {% when "vitamine-d" %}
                    <li><a class="badge-link-card" href="{{ '/micronutriments/vitamine-d/' | relative_url }}" title="Vitamine D">ğŸŒ¤ï¸</a></li>
                  {% when "vitamine-e" %}
                    <li><a class="badge-link-card" href="{{ '/micronutriments/vitamine-e/' | relative_url }}" title="Vitamine E">ğŸ›¡ï¸</a></li>
                  {% when "vitamine-k" %}
                    <li><a class="badge-link-card" href="{{ '/micronutriments/vitamine-k/' | relative_url }}" title="Vitamine K">ğŸ©¸</a></li>
                  {% when "vitamine-b9" %}
                    <li><a class="badge-link-card" href="{{ '/micronutriments/vitamine-b9/' | relative_url }}" title="Vitamine B9">ğŸŒ±</a></li>
                  {% when "vitamine-b12" %}
                    <li><a class="badge-link-card" href="{{ '/micronutriments/vitamine-b12/' | relative_url }}" title="Vitamine B12">ğŸ¥©</a></li>

                  {% when "calcium" %}
                    <li><a class="badge-link-card" href="{{ '/micronutriments/calcium/' | relative_url }}" title="Calcium">ğŸ¦´</a></li>
                  {% when "fer" %}
                    <li><a class="badge-link-card" href="{{ '/micronutriments/fer/' | relative_url }}" title="Fer">ğŸ§²</a></li>
                  {% when "magnesium" %}
                    <li><a class="badge-link-card" href="{{ '/micronutriments/magnesium/' | relative_url }}" title="MagnÃ©sium">âš¡</a></li>
                  {% when "potassium" %}
                    <li><a class="badge-link-card" href="{{ '/micronutriments/potassium/' | relative_url }}" title="Potassium">ğŸŒ</a></li>
                  {% when "zinc" %}
                    <li><a class="badge-link-card" href="{{ '/micronutriments/zinc/' | relative_url }}" title="Zinc">ğŸ”©</a></li>
                  {% when "selenium" %}
                    <li><a class="badge-link-card" href="{{ '/micronutriments/selenium/' | relative_url }}" title="SÃ©lÃ©nium">ğŸ§ª</a></li>
                  {% when "iode" %}
                    <li><a class="badge-link-card" href="{{ '/micronutriments/iode/' | relative_url }}" title="Iode">ğŸŒŠ</a></li>
                {% endcase %}
              {% endfor %}
            </ul>
          {% endif %}

          <details class="badges-legend">
            <summary>LÃ©gende des badges</summary>
            <ul>
              <li>ğŸ’ª TrÃ¨s protÃ©inÃ©</li>
              <li>ğŸ’© Riche en fibres</li>
              <li>â±ï¸ Rapide Ã  prÃ©parer</li>
              <li>â„ï¸ CongÃ©lable</li>
              <li>â™¨ï¸ Micro-ondable</li>
              <li>ğŸª¶ Peu calorique</li>
              <li>ğŸ”¥ Calorique</li>
              <li>ğŸŒ PrÃ©paration longue / temps passif important</li>
              <li>ğŸ¬ GoÃ»t sucrÃ©</li>
              <li>ğŸŸ OmÃ©ga-3</li>
              <li>ğŸ‘ï¸ Vitamine A</li>
              <li>ğŸ‹ Vitamine C</li>
              <li>ğŸŒ¤ï¸ Vitamine D</li>
              <li>ğŸ›¡ï¸ Vitamine E</li>
              <li>ğŸ©¸ Vitamine K</li>
              <li>ğŸŒ± Vitamine B9</li>
              <li>ğŸ¥© Vitamine B12</li>
              <li>ğŸ¦´ Calcium</li>
              <li>ğŸ§² Fer</li>
              <li>âš¡ MagnÃ©sium</li>
              <li>ğŸŒ Potassium</li>
              <li>ğŸ”© Zinc</li>
              <li>ğŸ§ª SÃ©lÃ©nium</li>
              <li>ğŸŒŠ Iode</li>
            </ul>
          </details>

        </div>
      </header>

      <div class="content-surface recipe-surface">
        {{ content }}
      </div>

      {% include footer.html %}

    </div>
  </main>

  {% include scripts.html %}
</body>
</html>

